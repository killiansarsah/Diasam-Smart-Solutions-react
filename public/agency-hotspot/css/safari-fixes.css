/* Safari-Specific Responsiveness Fixes */

/* Fix video autoplay and playback issues in Safari */
video {
    -webkit-playsinline: true;
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

/* Fix background-attachment: fixed issues on iOS Safari */
@supports (-webkit-touch-callout: none) {
    .section[style*="background-attachment: fixed"],
    .portfolio-bg,
    .section.slide2.about,
    .section.slide3.team,
    .contact-sec {
        background-attachment: scroll !important;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
}

/* Fix aspect-ratio support in Safari */
@supports not (aspect-ratio: 1) {
    .grid-item {
        position: relative;
        width: 100%;
        padding-bottom: 66.67%; /* 3:2 aspect ratio fallback */
    }
    
    .grid-item img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
}

/* Fix backdrop-filter support */
@supports not (backdrop-filter: blur(10px)) {
    @supports not (-webkit-backdrop-filter: blur(10px)) {
        .service-modal-content,
        .btn-glass-contact,
        .contact-form .contact_btn,
        .feature-item {
            background: rgba(0, 0, 0, 0.6) !important;
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
        }
    }
}

/* Fix viewport units on iOS Safari */
@supports (-webkit-touch-callout: none) {
    .section {
        min-height: -webkit-fill-available;
    }
    
    .portfolio-bg {
        height: -webkit-fill-available;
    }
}

/* Fix flexbox issues in Safari */
.works-grid {
    display: -webkit-grid;
    display: grid;
    -webkit-grid-template-columns: repeat(3, 1fr);
    grid-template-columns: repeat(3, 1fr);
}

/* Fix transform3d performance in Safari */
.team-card-professional,
.grid-item,
.feature-item {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}

/* ===================================
   Portfolio/Our Works Safari Zoom Fixes
====================================== */

/* Force hardware acceleration and prevent zoom glitches */
.portfolio-bg {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-perspective: 1000px;
    perspective: 1000px;
}

/* Grid item base state with GPU acceleration */
.grid-item {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    perspective: 1000px;
    will-change: transform;
    -webkit-font-smoothing: antialiased;
}

/* Safari-optimized hover transition */
.grid-item:hover {
    -webkit-transform: translate3d(0, -8px, 0) scale3d(1.02, 1.02, 1);
    transform: translate3d(0, -8px, 0) scale3d(1.02, 1.02, 1);
}

/* Grid item image zoom - Safari optimized */
.grid-item img {
    -webkit-transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
    transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-transition: -webkit-transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    will-change: transform;
}

.grid-item:hover img {
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.1, 1.1, 1);
    transform: translate3d(0, 0, 0) scale3d(1.1, 1.1, 1);
}

/* Works container GPU acceleration */
.works-container,
.works-grid {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
}

/* Navigation buttons Safari fix */
.nav-btn-bottom {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}

.nav-btn-bottom:hover {
    -webkit-transform: scale3d(1.15, 1.15, 1) translate3d(0, -2px, 0);
    transform: scale3d(1.15, 1.15, 1) translate3d(0, -2px, 0);
}

/* Active dot animation fix for Safari */
.dot {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
}

.dot.active {
    -webkit-transform: scale3d(1.4, 1.4, 1);
    transform: scale3d(1.4, 1.4, 1);
}

/* Safari-specific backdrop-filter optimization for Portfolio */
@supports (-webkit-backdrop-filter: blur(10px)) {
    .nav-btn-bottom,
    .nav-dots {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
}

/* Fallback for older Safari without backdrop-filter */
@supports not (-webkit-backdrop-filter: blur(10px)) {
    .nav-btn-bottom {
        background: rgba(255, 255, 255, 0.2) !important;
    }
    
    .nav-dots {
        background: rgba(0, 0, 0, 0.4) !important;
    }
}

/* Image Modal Safari Fixes */
.image-modal {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
}

.modal-image-container {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-perspective: 1000px;
    perspective: 1000px;
}

.modal-image {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}

/* Safari zoom animation fix for modal */
@-webkit-keyframes zoomIn {
    from { 
        -webkit-transform: scale3d(0.8, 0.8, 1); 
        transform: scale3d(0.8, 0.8, 1);
        opacity: 0; 
    }
    to { 
        -webkit-transform: scale3d(1, 1, 1); 
        transform: scale3d(1, 1, 1);
        opacity: 1; 
    }
}

@keyframes zoomIn {
    from { 
        -webkit-transform: scale3d(0.8, 0.8, 1); 
        transform: scale3d(0.8, 0.8, 1);
        opacity: 0; 
    }
    to { 
        -webkit-transform: scale3d(1, 1, 1); 
        transform: scale3d(1, 1, 1);
        opacity: 1; 
    }
}

.modal-nav-btn {
    -webkit-transform: translate3d(0, -50%, 0);
    transform: translate3d(0, -50%, 0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}

.modal-nav-btn:hover {
    -webkit-transform: translate3d(0, -50%, 0) scale3d(1.1, 1.1, 1);
    transform: translate3d(0, -50%, 0) scale3d(1.1, 1.1, 1);
}

/* Close button Safari rotation fix */
.modal-close {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
}

.modal-close:hover {
    -webkit-transform: rotate(90deg) scale3d(1.1, 1.1, 1);
    transform: rotate(90deg) scale3d(1.1, 1.1, 1);
}

/* ===================================
   End Portfolio Safari Fixes
====================================== */

/* Mobile Safari specific fixes */
@media (max-width: 767px) {
    /* Fix 100vh issues on mobile Safari */
    .section {
        min-height: 100vh;
        min-height: -webkit-fill-available;
    }
    
    /* Fix input zoom on iOS */
    input, textarea, select {
        font-size: 16px !important;
    }
    
    /* Reduce transform complexity on mobile Safari */
    .grid-item:hover {
        -webkit-transform: translate3d(0, -4px, 0);
        transform: translate3d(0, -4px, 0);
    }
    
    .grid-item:hover img {
        -webkit-transform: scale3d(1.05, 1.05, 1);
        transform: scale3d(1.05, 1.05, 1);
    }
}

/* ===================================
   Additional iOS Safari Fixes
====================================== */

/* Dynamic viewport height for iOS 15+ */
@supports (height: 100dvh) {
    .slider-area,
    .about,
    .team,
    .portfolio-bg,
    .contact-sec {
        min-height: 100dvh;
    }
    
    .side_nav {
        height: 100dvh;
    }
}

/* Fix for safe area insets (notch/home indicator) */
@supports (padding: env(safe-area-inset-top)) {
    .mobile-nav {
        padding-top: env(safe-area-inset-top);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
    }
    
    .broad {
        padding-bottom: env(safe-area-inset-bottom);
    }
    
    .slider-area,
    .about,
    .team,
    .portfolio-bg,
    .contact-sec {
        padding-bottom: env(safe-area-inset-bottom);
    }
}

/* Smooth momentum scrolling on iOS */
.pp-scrollable,
.service-modal-container,
.broad,
#team-slider {
    -webkit-overflow-scrolling: touch;
}

/* Fix sticky positioning issues on iOS Safari */
@supports (-webkit-touch-callout: none) {
    .mobile-nav {
        position: -webkit-sticky;
        position: sticky;
        top: 0;
    }
    
    /* Prevent rubber-banding at top/bottom */
    html {
        overscroll-behavior: none;
    }
}

/* Fix for button and input tap highlight */
a, button, input, textarea, select {
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    -webkit-tap-highlight-color: transparent;
}

/* Fix for form elements on iOS */
input[type="text"],
input[type="email"],
input[type="tel"],
input[type="password"],
textarea {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 0;
}

/* Fix image rendering on high-DPI iOS screens */
img {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
}

/* Fix for landscape orientation on iPhone */
@media screen and (max-width: 896px) and (orientation: landscape) {
    @supports (-webkit-touch-callout: none) {
        .section {
            min-height: auto;
            min-height: -webkit-fill-available;
        }
    }
}

/* Fix for Safari grid gap bug */
@supports (-webkit-touch-callout: none) {
    .works-grid {
        grid-gap: var(--grid-gap, 15px);
        gap: var(--grid-gap, 15px);
    }
}

/* Fix backdrop-filter performance on Safari */
@supports (-webkit-backdrop-filter: blur(10px)) {
    .mobile-nav,
    .btn-glass-contact,
    .service-modal-content,
    .feature-item {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
    }
}