/* ===================================
   Safari/WebKit Compatibility Fixes
   For all Apple devices: Mac, iPad, iPhone
   
   This file addresses WebKit-specific rendering 
   differences to match Chrome/Windows appearance
====================================== */

/* ===================================
   GLOBAL WEBKIT FIXES
====================================== */

/* Fix for Safari's flex gap inconsistencies */
@supports (-webkit-touch-callout: none) {
  .row {
    gap: 0;
  }
}

/* Prevent Safari text size adjust */
html {
  -webkit-text-size-adjust: 100%;
}

/* Fix for Safari smooth scrolling */
html, body {
  -webkit-overflow-scrolling: touch;
}

/* Ensure proper box-sizing in Safari */
*, *::before, *::after {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}

/* ===================================
   BACKDROP FILTER (Safari needs prefix)
====================================== */

.feature-item,
.about .box,
.service-modal-content {
  -webkit-backdrop-filter: blur(20px);
  backdrop-filter: blur(20px);
}

/* Fallback for older Safari versions without backdrop-filter */
@supports not ((-webkit-backdrop-filter: blur(20px)) or (backdrop-filter: blur(20px))) {
  .feature-item {
    background: rgba(30, 60, 90, 0.85) !important;
  }
  
  .about .box {
    background: rgba(255, 255, 255, 0.2) !important;
  }
}

/* ===================================
   FLEXBOX SAFARI FIXES
====================================== */

/* Safari flexbox alignment fixes */
.about .row.pb-5 {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
  -webkit-flex-direction: row;
  flex-direction: row;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
}

.about .row.pb-5 > div[class*="col-"] {
  -webkit-box-flex: 1;
  -webkit-flex: 1;
  flex: 1;
  min-width: 0; /* Prevent flex items from overflowing */
}

/* Fix Service Locations positioning in Safari */
.about .col-12.px-0.mt-4 {
  margin-top: 1.5rem !important;
  padding-top: 0 !important;
  position: relative;
  clear: both;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

.about .col-12.px-0.mt-4 p {
  margin-top: 0 !important;
  padding-top: 0 !important;
  line-height: 1.6 !important;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Ensure box doesn't push content up */
.about .box {
  margin-bottom: 1rem !important;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* ===================================
   VIDEO ELEMENT (Banner)
====================================== */

/* Ensure video covers properly in Safari */
#home-banner video,
.slider-area video {
  -o-object-fit: cover;
  object-fit: cover;
  -o-object-position: center;
  object-position: center;
  width: 100%;
  height: 100%;
}

/* Safari video autoplay fix - ensure controls are hidden */
video::-webkit-media-controls {
  display: none !important;
}

video::-webkit-media-controls-enclosure {
  display: none !important;
}

video::-webkit-media-controls-panel {
  display: none !important;
}

/* ===================================
   SVG RENDERING (Banner Shape)
====================================== */

/* Fix SVG rendering in Safari */
.banner-image svg {
  overflow: visible;
  transform: translateZ(0); /* Force GPU rendering */
  -webkit-transform: translateZ(0);
}

.banner-image svg image {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* ===================================
   GRADIENT TEXT (Safari needs prefix)
====================================== */

.feature-item .f-icon,
.about .section-heading h2 .grey-color {
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Fallback for gradient text */
@supports not (-webkit-background-clip: text) {
  .feature-item .f-icon {
    color: #ffffff;
    background: none;
  }
}

/* ===================================
   TRANSFORM & ANIMATION FIXES
====================================== */

/* Use webkit prefixes for transforms */
.feature-item:hover,
.product-card:hover,
.team-card-professional:hover {
  -webkit-transform: translateY(-5px);
  transform: translateY(-5px);
}

/* Ensure animations use webkit prefixes */
@-webkit-keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@-webkit-keyframes slideInLeft {
  from {
    -webkit-transform: translateX(-100%);
    transform: translateX(-100%);
    opacity: 0;
  }
  to {
    -webkit-transform: translateX(0);
    transform: translateX(0);
    opacity: 1;
  }
}

@-webkit-keyframes slideInRight {
  from {
    -webkit-transform: translateX(100%);
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    -webkit-transform: translateX(0);
    transform: translateX(0);
    opacity: 1;
  }
}

@-webkit-keyframes zoomIn {
  from {
    -webkit-transform: scale(0.5);
    transform: scale(0.5);
    opacity: 0;
  }
  to {
    -webkit-transform: scale(1);
    transform: scale(1);
    opacity: 1;
  }
}

/* ===================================
   SCROLLBAR STYLING (Safari)
====================================== */

/* Custom scrollbar for Safari */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: #1a1a1a;
}

::-webkit-scrollbar-thumb {
  background: #555;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #777;
}

/* ===================================
   FORM ELEMENTS (Contact Section)
====================================== */

/* Safari input styling fixes */
input, textarea, select {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  border-radius: 0; /* Remove iOS rounded corners */
}

/* Fix Safari autofill styling */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
textarea:-webkit-autofill {
  -webkit-box-shadow: 0 0 0 1000px rgba(255,255,255,0.1) inset !important;
  -webkit-text-fill-color: #ffffff !important;
  transition: background-color 5000s ease-in-out 0s;
}

/* ===================================
   SIDE NAVIGATION (Safari Position Fixed)
====================================== */

/* Safari position fixed inside transformed elements fix */
.side_nav {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  will-change: transform;
}

.side-nav-menu .social-icons {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* ===================================
   OWL CAROUSEL (Team Section) - Safari
====================================== */

.owl-carousel {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}

.owl-carousel .owl-stage {
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

.owl-carousel .owl-item {
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* Fix owl nav/dots for Safari */
.owl-carousel .owl-nav button,
.owl-carousel .owl-dots button {
  -webkit-appearance: none;
  appearance: none;
}

/* ===================================
   PORTFOLIO GRID - Safari Fixes
====================================== */

.portfolio-grid {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
}

.product-card {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

.product-image img {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  -o-object-fit: contain;
  object-fit: contain;
}

/* ===================================
   MODAL FIXES (Service Modals)
====================================== */

.service-modal-enhanced {
  -webkit-overflow-scrolling: touch;
}

.service-modal-container {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* ===================================
   IPAD SPECIFIC FIXES
====================================== */

@media screen and (min-width: 768px) and (max-width: 1024px) {
  /* iPad Portrait & Landscape */
  
  /* Ensure full viewport height */
  .section {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }
  
  /* Fix for iPad viewport height bug */
  #pagepiling {
    height: 100vh;
    height: -webkit-fill-available;
  }
  
  /* Ensure side nav doesn't overlap content */
  .side_nav {
    z-index: 9999;
  }
  
  /* Feature items - 2 per row on iPad */
  .about .row.pb-5 {
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
  }
  
  .about .row.pb-5 > div[class*="col-"] {
    -webkit-box-flex: 0;
    -webkit-flex: 0 0 48%;
    flex: 0 0 48%;
    max-width: 48%;
    margin-bottom: 15px;
  }
  
  /* Team section on iPad */
  .team .row.align-items-stretch {
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -webkit-flex-direction: column;
    flex-direction: column;
  }
  
  /* Portfolio grid - 2 columns on iPad */
  .portfolio-grid .col-lg-4 {
    -webkit-box-flex: 0;
    -webkit-flex: 0 0 50%;
    flex: 0 0 50%;
    max-width: 50%;
  }
}

/* iPad Pro 12.9" Landscape */
@media screen and (min-width: 1024px) and (max-width: 1366px) and (orientation: landscape) {
  .about .row.pb-5 {
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
  }
  
  .about .row.pb-5 > div[class*="col-"] {
    -webkit-flex: 1;
    flex: 1;
    max-width: none;
  }
}

/* ===================================
   IPHONE SPECIFIC FIXES
====================================== */

@media screen and (max-width: 767px) {
  /* iPhone All Models */
  
  /* Fix for iPhone viewport height (accounts for Safari UI) */
  .section,
  #pagepiling > section {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }
  
  /* Ensure touch scrolling works smoothly */
  #pagepiling {
    -webkit-overflow-scrolling: touch;
    overflow-y: auto;
  }
  
  /* Mobile nav touch targets */
  .mobile-nav .my_nav_tog {
    min-width: 44px;
    min-height: 44px;
    display: -webkit-flex;
    display: flex;
    -webkit-align-items: center;
    align-items: center;
    -webkit-justify-content: center;
    justify-content: center;
  }
  
  /* Ensure video covers on iPhone */
  .slider-area video {
    -o-object-fit: cover;
    object-fit: cover;
    min-height: 100%;
  }
  
  /* Feature items stack on iPhone */
  .about .row.pb-5 {
    -webkit-flex-direction: column;
    flex-direction: column;
  }
  
  .about .row.pb-5 > div[class*="col-"] {
    -webkit-flex: 0 0 100%;
    flex: 0 0 100%;
    max-width: 100%;
    margin-bottom: 15px;
  }
  
  /* Fix contact form on iPhone */
  .contact-form input,
  .contact-form textarea {
    font-size: 16px !important; /* Prevents zoom on focus */
  }
}

/* iPhone SE & iPhone 12 Mini (small screens) */
@media screen and (max-width: 375px) {
  .slider-area h1 {
    font-size: 28px !important;
  }
  
  .slider-area p {
    font-size: 14px !important;
  }
  
  .feature-item {
    padding: 15px 12px;
  }
  
  .feature-item .title {
    font-size: 1rem !important;
  }
  
  .feature-item p {
    font-size: 13px !important;
  }
}

/* iPhone Pro Max (large phones) */
@media screen and (min-width: 414px) and (max-width: 430px) {
  .slider-area h1 {
    font-size: 32px !important;
  }
  
  .about .section-heading h2 {
    font-size: 1.6rem !important;
  }
}

/* ===================================
   MACBOOK/MAC DESKTOP SAFARI FIXES
====================================== */

@media screen and (min-width: 1200px) {
  /* MacBook Air 13" (1280x800) */
  @media screen and (max-width: 1366px) {
    .about .row.pb-5 > div[class*="col-"] {
      padding: 0 10px;
    }
    
    .feature-item {
      padding: 20px 15px;
    }
  }
  
  /* MacBook Pro & iMac */
  .section {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
  
  /* Ensure PagePiling works smoothly */
  #pagepiling {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
}

/* ===================================
   HIGH DPI / RETINA DISPLAY FIXES
====================================== */

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  /* Sharper images on Retina */
  img {
    image-rendering: -webkit-optimize-contrast;
  }
  
  /* Sharper text rendering */
  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* ===================================
   TOUCH DEVICE HOVER STATE FIXES
====================================== */

@media (hover: none) and (pointer: coarse) {
  /* Remove hover effects on touch devices */
  .feature-item:hover {
    -webkit-transform: none;
    transform: none;
  }
  
  .product-card:hover {
    -webkit-transform: none;
    transform: none;
  }
  
  /* Use active state instead */
  .feature-item:active {
    -webkit-transform: scale(0.98);
    transform: scale(0.98);
  }
  
  .product-card:active {
    -webkit-transform: scale(0.98);
    transform: scale(0.98);
  }
}

/* ===================================
   SAFE AREA INSETS (iPhone X+, notch)
====================================== */

@supports (padding: env(safe-area-inset-top)) {
  .mobile-nav {
    padding-top: env(safe-area-inset-top);
  }
  
  #contact {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .side_nav {
    padding-left: env(safe-area-inset-left);
  }
}

/* ===================================
   PRINT STYLES (Safari Print)
====================================== */

@media print {
  .side_nav,
  .mobile-nav,
  video,
  .owl-nav,
  .owl-dots {
    display: none !important;
  }
  
  .section {
    page-break-inside: avoid;
    break-inside: avoid;
  }
}
